\hypertarget{wave__file__reader_8h}{}\doxysection{/home/shaokai/lingua-\/franca-\/master/git/lingua-\/franca/org.lflang/src/lib/\+C/util/wave\+\_\+file\+\_\+reader.h File Reference}
\label{wave__file__reader_8h}\index{/home/shaokai/lingua-\/franca-\/master/git/lingua-\/franca/org.lflang/src/lib/C/util/wave\_file\_reader.h@{/home/shaokai/lingua-\/franca-\/master/git/lingua-\/franca/org.lflang/src/lib/C/util/wave\_file\_reader.h}}
\doxysubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structlf__waveform__t}{lf\+\_\+waveform\+\_\+t}}
\end{DoxyCompactItemize}
\doxysubsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef struct \mbox{\hyperlink{structlf__waveform__t}{lf\+\_\+waveform\+\_\+t}} \mbox{\hyperlink{wave__file__reader_8h_a464bd5c31a1a562536e2a54213135604}{lf\+\_\+waveform\+\_\+t}}
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{structlf__waveform__t}{lf\+\_\+waveform\+\_\+t}} $\ast$ \mbox{\hyperlink{wave__file__reader_8h_a428c2db9a5e86cf61e6cf3f9d2ea51ad}{read\+\_\+wave\+\_\+file}} (const char $\ast$path)
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\begin{DoxyAuthor}{Author}
Edward A. Lee
\end{DoxyAuthor}
\hypertarget{util_8h_LICENSE}{}\doxysubsection{L\+I\+C\+E\+N\+SE}\label{util_8h_LICENSE}
Copyright (c) 2020, The University of California at Berkeley and TU Dresden

Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met\+:


\begin{DoxyEnumerate}
\item Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
\item Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.
\end{DoxyEnumerate}

T\+H\+IS S\+O\+F\+T\+W\+A\+RE IS P\+R\+O\+V\+I\+D\+ED BY T\+HE C\+O\+P\+Y\+R\+I\+G\+HT H\+O\+L\+D\+E\+RS A\+ND C\+O\+N\+T\+R\+I\+B\+U\+T\+O\+RS \char`\"{}\+A\+S I\+S\char`\"{} A\+ND A\+NY E\+X\+P\+R\+E\+SS OR I\+M\+P\+L\+I\+ED W\+A\+R\+R\+A\+N\+T\+I\+ES, I\+N\+C\+L\+U\+D\+I\+NG, B\+UT N\+OT L\+I\+M\+I\+T\+ED TO, T\+HE I\+M\+P\+L\+I\+ED W\+A\+R\+R\+A\+N\+T\+I\+ES OF M\+E\+R\+C\+H\+A\+N\+T\+A\+B\+I\+L\+I\+TY A\+ND F\+I\+T\+N\+E\+SS F\+OR A P\+A\+R\+T\+I\+C\+U\+L\+AR P\+U\+R\+P\+O\+SE A\+RE D\+I\+S\+C\+L\+A\+I\+M\+ED. IN NO E\+V\+E\+NT S\+H\+A\+LL T\+HE C\+O\+P\+Y\+R\+I\+G\+HT H\+O\+L\+D\+ER OR C\+O\+N\+T\+R\+I\+B\+U\+T\+O\+RS BE L\+I\+A\+B\+LE F\+OR A\+NY D\+I\+R\+E\+CT, I\+N\+D\+I\+R\+E\+CT, I\+N\+C\+I\+D\+E\+N\+T\+AL, S\+P\+E\+C\+I\+AL, E\+X\+E\+M\+P\+L\+A\+RY, OR C\+O\+N\+S\+E\+Q\+U\+E\+N\+T\+I\+AL D\+A\+M\+A\+G\+ES (I\+N\+C\+L\+U\+D\+I\+NG, B\+UT N\+OT L\+I\+M\+I\+T\+ED TO, P\+R\+O\+C\+U\+R\+E\+M\+E\+NT OF S\+U\+B\+S\+T\+I\+T\+U\+TE G\+O\+O\+DS OR S\+E\+R\+V\+I\+C\+ES; L\+O\+SS OF U\+SE, D\+A\+TA, OR P\+R\+O\+F\+I\+TS; OR B\+U\+S\+I\+N\+E\+SS I\+N\+T\+E\+R\+R\+U\+P\+T\+I\+ON) H\+O\+W\+E\+V\+ER C\+A\+U\+S\+ED A\+ND ON A\+NY T\+H\+E\+O\+RY OF L\+I\+A\+B\+I\+L\+I\+TY, W\+H\+E\+T\+H\+ER IN C\+O\+N\+T\+R\+A\+CT, S\+T\+R\+I\+CT L\+I\+A\+B\+I\+L\+I\+TY, OR T\+O\+RT (I\+N\+C\+L\+U\+D\+I\+NG N\+E\+G\+L\+I\+G\+E\+N\+CE OR O\+T\+H\+E\+R\+W\+I\+SE) A\+R\+I\+S\+I\+NG IN A\+NY W\+AY O\+UT OF T\+HE U\+SE OF T\+H\+IS S\+O\+F\+T\+W\+A\+RE, E\+V\+EN IF A\+D\+V\+I\+S\+ED OF T\+HE P\+O\+S\+S\+I\+B\+I\+L\+I\+TY OF S\+U\+CH D\+A\+M\+A\+GE.\hypertarget{util_8h_DESCRIPTION}{}\doxysubsection{D\+E\+S\+C\+R\+I\+P\+T\+I\+ON}\label{util_8h_DESCRIPTION}
Utility functions and data types for importing audio files with the wave audio format. The main function is \mbox{\hyperlink{wave__file__reader_8h_a428c2db9a5e86cf61e6cf3f9d2ea51ad}{read\+\_\+wave\+\_\+file()}}, which, given a path to a .wav file, reads the file and, if the format of the file is supported, returns an \mbox{\hyperlink{structlf__waveform__t}{lf\+\_\+waveform\+\_\+t}} struct, which contains the raw audio data in 16-\/bit linear P\+CM form.

This code has few dependencies, so it should run on just about any platform.

To use this, include the following flags in your target properties\+: 
\begin{DoxyPre}
   target C \{
       files: ["/lib/C/util/wave\_file\_reader.c", "/lib/C/util/wave\_file\_reader.h"]
   \};
   \end{DoxyPre}


In addition, you need this in your Lingua Franca file\+: 
\begin{DoxyPre}
   preamble \{=
       \#include "wave\_file\_reader.c"
   =\}
   \end{DoxyPre}
 

\doxysubsection{Typedef Documentation}
\mbox{\Hypertarget{wave__file__reader_8h_a464bd5c31a1a562536e2a54213135604}\label{wave__file__reader_8h_a464bd5c31a1a562536e2a54213135604}} 
\index{wave\_file\_reader.h@{wave\_file\_reader.h}!lf\_waveform\_t@{lf\_waveform\_t}}
\index{lf\_waveform\_t@{lf\_waveform\_t}!wave\_file\_reader.h@{wave\_file\_reader.h}}
\doxysubsubsection{\texorpdfstring{lf\_waveform\_t}{lf\_waveform\_t}}
{\footnotesize\ttfamily typedef struct \mbox{\hyperlink{structlf__waveform__t}{lf\+\_\+waveform\+\_\+t}} \mbox{\hyperlink{structlf__waveform__t}{lf\+\_\+waveform\+\_\+t}}}

Waveform in 16-\/bit linear-\/\+P\+CM format. The waveform element is an array containing audio samples. If there are two channels, then they are interleaved left and right channel. The length is the total number of samples, a multiple of the number of channels. 

\doxysubsection{Function Documentation}
\mbox{\Hypertarget{wave__file__reader_8h_a428c2db9a5e86cf61e6cf3f9d2ea51ad}\label{wave__file__reader_8h_a428c2db9a5e86cf61e6cf3f9d2ea51ad}} 
\index{wave\_file\_reader.h@{wave\_file\_reader.h}!read\_wave\_file@{read\_wave\_file}}
\index{read\_wave\_file@{read\_wave\_file}!wave\_file\_reader.h@{wave\_file\_reader.h}}
\doxysubsubsection{\texorpdfstring{read\_wave\_file()}{read\_wave\_file()}}
{\footnotesize\ttfamily \mbox{\hyperlink{structlf__waveform__t}{lf\+\_\+waveform\+\_\+t}}$\ast$ read\+\_\+wave\+\_\+file (\begin{DoxyParamCaption}\item[{const char $\ast$}]{path }\end{DoxyParamCaption})}

Open a wave file, check that the format is supported, allocate memory for the sample data, and fill the memory with the sample data. It is up to the caller to free the memory when done with it. That code should first free the waveform element of the returned struct, then the struct itself. This implementation supports only 16-\/bit linear P\+CM files. On a Mac, you can convert audio files into this format using the afconvert utility.


\begin{DoxyParams}{Parameters}
{\em path} & The path to the file. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
An array of sample data or N\+U\+LL if the file can\textquotesingle{}t be opened or has an usupported format. 
\end{DoxyReturn}
